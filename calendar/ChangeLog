2003-12-09  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.[ch]: made the connections be
	shared.
	(e_gw_connection_new): get the uri, username and password here, and
	before trying to login again to the server, see if we have already
	the same connection request in the loaded connections hash table.
	(e_gw_connection_login): removed.
	(e_gw_connection_logout): just unref the connection, the logout code
	moved to...
	(logout): ...here.
	(e_gw_connection_dispose): free new members.
	(e_gw_connection_finalize): remove the connection from the hash table,
	and destroy the hash table when there are no more connections on it.

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_open): use the new EGwConnection interface.

2003-12-08  Rodrigo Moya <rodrigo@ximian.com>

	* libedata-cal/e-cal-backend-cache.h: the class structure derives
	from EFileCacheClass, not EFileCache.

	* libedata-cal/e-cal-backend-cache.c (get_filename_from_uri): iterate
	correctly over the characters in the URI.

2003-12-08  Rodrigo Moya <rodrigo@ximian.com>

	* libedata-cal/e-cal-backend-cache.[ch]: use EFileCache instead
	of ECache.

2003-12-08  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c (convert_uri):
	new function to convert "groupwise://" URIs to "http://".
	(e_cal_backend_groupwise_open): call the above function to
	get a GnomeVFSURI, and use it as a temporary hack to get
	username and password.

2003-12-07  JP Rosevear  <jpr@ximian.com>

	* libedata-cal/e-data-cal-factory.c: version the oafiid

	* libecal/e-cal.c (get_factories): update the repo id
	
2003-12-07  JP Rosevear  <jpr@ximian.com>

	* libecal/e-cal.c (get_factories): use the versioned repo id

2003-12-04  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/create-account.c (add_account): add the username
	in the source URI, and use e_source_list_sync, to give it time to
	sync the GConf changes.

2003-12-04  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/create-account.c: changed to use a main loop,
	or saving to GConf seems not to work ??

2003-12-04  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/create-account.c (add_account): add the source
	to the group.

2003-12-04  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/create-account.c: make it use a username also.

2003-12-04  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/create-account.c: added simple program to
	add accounts to the calendar sources until we a GUI to configure
	them.

	* backends/groupwise/Makefile.am: added noinst program.

2003-12-03  Christian Kellnerc <gicmo@xatom.net>

         * libedata-cal/e-cal-backend-sexp.c: added has-recurrences sexp
	 function

2003-12-03  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c: use a cache
	to keep the objects from the server.
	(e_cal_backend_groupwise_finalize): unref the cache object.
	(e_cal_backend_groupwise_open): load/create the local cache.
	(e_cal_backend_groupwise_get_object): look for the object in
	the cache.
	(e_cal_backend_groupwise_class_init): fixed warning.

2003-12-01  William Jon McCann  <mccann@jhu.edu>
 
        * libecal/e-cal.c (e_cal_generate_instances): Fix query and
        get object list as components.
 
2003-12-01  Rodrigo Moya <rodrigo@ximian.com>

	* libedata-cal/e-cal-backend-cache.[ch]: changed to be based on the
	new ECache class.
	(get_filename_from_uri): new function to get a unique filename for a
	calendar/tasks URI.
	(e_cal_backend_cache_set_property): get the filename for the given URI
	and set the "filename" property on the cache, which will load/create
	the cache file.
	(e_cal_backend_cache_finalize): dont free removed fields.
	(e_cal_backend_cache_get_component, e_cal_backend_cache_add_component,
	e_cal_backend_cache_replace_component, e_cal_backend_cache_remove_component):
	new functions.

	* backends/groupwise/e-gw-connection.c (e_gw_connection_login): retrieve
	the session from the response, not the username.

2003-11-28  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.c (parse_response_status): new
	function to parse the "status" field returned in the SOAP response.
	(e_gw_connection_login, e_gw_connection_logout): call above function
	to get the status, and return that to the caller.
	
	* backends/groupwise/TODO: updated with more tasks.

2003-11-27  Rodrigo Moya <rodrigo@ximian.com>

	* libedata-cal/e-cal-backend-cache.[ch]: new class implementing a
	cache of calendar/tasks objects.

	* libedata-cal/Makefile.am: added new files.

2003-11-26  Hans Petter Jansson  <hpj@ximian.com>

	* idl/Evolution-DataServer-Calendar.idl (getCal): Take source XML
	instead of URI.

	* libecal/client-test.c (create_client): Adapt to API changes.
	(main): Ditto.

	* libecal/e-cal.c (fetch_corba_cal): Move to ESource.
	(e_cal_new): Take ESource.
	(e_cal_new_from_uri): Implement convenience call that takes URI.

	* libedata-cal/e-cal-backend.c (e_cal_backend_set_property):
	Implement PROP_SOURCE.
	(e_cal_backend_get_property): Same.
	(e_cal_backend_class_init): Same.
	(e_cal_backend_get_source): Same.

	* libedata-cal/e-data-cal-factory.c (impl_CalFactory_getCal): Take
	source XML and construct an ESource. Init backend with that.

2003-11-25  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-message.[ch]: new files to contain utility
	functions for easily creating SOAP messages.

	* backends/groupwise/e-gw-connection.[ch] (e_gw_connection_logout):
	new function.
	(e_gw_connection_finalize): if we're already connected, call
	e_gw_connection_logout().
	(e_gw_connection_login): implement response parsing.
	(e_gw_connection_send_message): new function.

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_is_loaded): implemented.

	* backends/groupwise/Makefile.am: added new files.

2003-11-20  Harry Lu  <harry.lu@sun.com>

	* backends/file/e-cal-backend-file.c:
	(e_cal_backend_file_internal_get_default_timezone): move to the front
	to avoid a compile warning.
	(e_cal_backend_file_internal_get_timezone): ditto.
	(sanitize_component): new function. If the component's timezone is not
	included in buildin timezone list, convert it to local default timezone.
	(e_cal_backend_file_create_object): call sanitize_component.
	(e_cal_backend_file_modify_object): ditto.
	(e_cal_backend_file_receive_objects): ditto.

2003-11-18  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.h: fixed typo.

	* backends/groupwise/e-gw-connection.c: base it on GObject, not
	SoupConnection.
	(e_gw_connection_login): new functions.
	(e_gw_connection_init): create the SoupSession here if it's not
	created, or ref it if it's already created.
	(e_gw_connection_finalize): unref the SoupSession here.
	(session_weak_ref_cb): callback to detect when the SoupSession dies.

	* backends/groupwise/e-cal-backend-groupwise.c: make it use
	EGwConnection's.
	(e_cal_backend_groupwise_finalize): unref the EGwConnection.
	(e_cal_backend_groupwise_open): create the EGwConnection here.

2003-11-17  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/gw-connection.[ch]: new class for managing
	connections to Groupwise servers.

	* backends/groupwise/Makefile.am: added new files and needed
	CFLAGS and LIBS.

2003-11-17  Dan Winship  <danw@ximian.com>

	* libecal/e-cal-util.c (e_cal_util_new_component): New
	icalcomponent-based replacement for
	e_cal_component_new/e_cal_component_set_vtype.

	* libedata-cal/e-data-cal.c: fix up some broken indentation
	(e_data_cal_notify_default_object, e_data_cal_notify_object):
	constify the object arg

2003-11-14  Rodrigo Moya <rodrigo@ximian.com>

	* backends/Makefile.am: added groupwise backend directory to build.

	* backends/groupwise/Makefile.am:
	* backends/groupwise/e-cal-backend-groupwise.[ch]: Groupwise backend
	skeleton.

2003-11-11  ChangeLog <jpr@ximian.com>

	* libecal/e-cal.c (e_cal_class_init): emit the status

	* libecal/e-cal.h: remove open status enums, use calendar status
	instead

	* libecal/client-test.c (create_client): just directly open the
	calendar, no need to be async

2003-11-11  Dan Winship  <danw@ximian.com>

	* libedata-cal/e-cal-backend-sexp.c: Make the time-related sexp
	function handlers (eg, time-now, make-time, etc) be non-static, so
	they can be reused by backend-specific calendar sexp parsers.

2003-11-10  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.h: remove dead enums

2003-11-10  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.h: mark struct as private

	* libecal/e-cal.c: fix documentation headers

	* libecal/e-cal-view.h: fix cast macros and typedef the structs
	separately

	* libecal/e-cal-view.c: use correct type check macro, fix some
	documentation headers

	* libecal/e-cal-view-listener.h: typedef the structs separately
	and tidy up class macros

	* libecal/e-cal-util.c: fix a documentation header

	* libecal/e-cal-listener.h: mark parts of the struct as private

	* libecal/e-cal-listener.c: fix a few documentation headers

	* libecal/e-cal-component.h: remove extraneous comma and mark
	parts of struct as private

	* libecal/e-cal-component.c: fix a couple of documentation headers

2003-11-10  Dan Winship  <danw@ximian.com>

	* libedata-cal/e-cal-backend-sexp.c: Remove get-vtype from the
	query language, since it is redundant now.
	(func_has_alarms): Remove the boolean arg from has-alarms. You can
	just say (not (has-alarms?)).

2003-11-10  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.h: add proto

	* libecal/e-cal.c (e_cal_free_change_list): this belongs here

	* libecal/e-cal-types.h: remove proto

	* libecal/Makefile.am: don't build dead file

2003-11-07  Dan Winship  <danw@ximian.com>

	* libecal/Makefile.am (libecal_la_LDFLAGS): Remove -no-undefined

	* libedata-cal/Makefile.am (libedata_cal_la_LDFLAGS): Likewise

2003-11-06    <jpr@ximian.com>

	* libecal/e-cal-view-listener.h: match the signals better

	* libecal/e-cal-view-listener.c (e_cal_view_listener_class_init):
	ditto
	
2003-11-06  JP Rosevear  <jpr@ximian.com>

	* libecal/e-cal.c: replace e_mutex stuff with gthread stuff

2003-11-06  JP Rosevear <jpr@ximian.com>

	* Makefile.am: build new subdirs

	* backends/*: build the http and file backends here

	* libedata-cal/Makefile.am: no longer build them here	
	
2003-11-05  JP Rosevear  <jpr@ximian.com>

	* rename libedatacal to libedata-cal

2003-11-05  JP Rosvear <jpr@ximian.com>

	* libecal/Makefile.am: use privincludedir

	* libedatacal/Makefile.am: ditto

	* libecal/libecal-1.0.pc.in: ditto

	* libedatacal/libedatacal-1.0.pc.in: use privincludedir; remove
	gal

2003-11-05  JP Rosevear <jpr@ximian.com>

	* libecal/Makefile.am: LIBADD all the relevant libical libs

	* libecal/libecal-1.0.pc.in: no need to explicitly link
	libical-evolution

	* libedatacal/libedatacal-1.0.pc.in: ditto; fix include dir
	
2003-11-05  Rodrigo Moya <rodrigo@ximian.com>

	* libedatacal/e-cal-backend-sexp.c: removed GAL dependency.

2003-11-04  JP Rosevear <jpr@ximian.com>

	* libedatacal/e-data-cal-factory.c: use properly name spaced
	default id

2003-11-04  JP Rosevear <jpr@ximian.com>

	* libecal/libecal-1.0.pc.in (prefix): include priv dir stuff for
	libical

	* libedatacal/libedatacal-1.0.pc.in (prefix): ditto
	
	* libecal/e-cal-component.[hc]: properly name space alarm action
	enum

	* libecal/e-cal-types.h: properly name space change types	
	
2003-11-04  JP Rosevear <jpr@ximian.com>

	* libedatacal/e-data-cal-factory.c: remove corba header include

	* libedatacal/e-cal-backend-sync.h: include corba header properly
	
	* libedatacal/e-data-cal.h: ditto

	* libedatacal/e-data-cal-view.h: ditto

	* libedatacal/e-data-cal-factory.h: ditto

	* libedatacal/e-cal-backend.h: ditto

	* libedatacal/Makefile.am: reflect idl name change

	* libecal/e-cal-listener.h: include corba header properly

	* libecal/e-cal-view.h: ditto

	* libecal/e-cal-view-listener.h: ditto

	* libecal/Makefile.am: reflect idl name change

	* idl/Makefile.am: rename the idl to Evolution-DataServer-Calendar.idl

2003-11-03  Hans Petter Jansson  <hpj@ximian.com>

	* calendar/libedatacal/e-cal-backend-file.c (free_calendar_components)
	(free_calendar_data): Implement.
	(e_cal_backend_file_dispose): Use above freers.
	(get_uri_string_for_gnome_vfs): Implement.
	(open_cal): Set priv->uri to be escaped, GnomeVFS-friendly.
	(notify_removals_cb)
	(notify_adds_modifies_cb)
	(notify_changes)
	(reload_cal): Implement.
	(create_cal): Set priv->uri to be escaped, GnomeVFS-friendly.
	(get_uri_string): Implement - unescapes once.
	(e_cal_backend_file_compute_changes): Unescape DB URI once, don't make
	like it's in a subdirectory.
	(e_cal_backend_file_reload): Implement.

	* calendar/libedatacal/e-cal-backend-http.c
	(e_cal_backend_http_finalize): Cancel potential retrieval and free
	slave backend.
	(e_cal_backend_http_is_read_only): Clean up.
	(webcal_to_http_method)
	(uri_to_cache_dir)
	(ensure_cache_dir)
	(retrieval_done)
	(retrieval_progress_cb)
	(begin_retrieval_cb): Implement.
	(e_cal_backend_http_open): Set up slave backend.
	(e_cal_backend_http_remove)
	(e_cal_backend_http_is_loaded)
	(e_cal_backend_http_get_default_object)
	(e_cal_backend_http_get_object)
	(e_cal_backend_http_get_timezone)
	(e_cal_backend_http_add_timezone)
	(e_cal_backend_http_set_default_timezone)
	(e_cal_backend_http_get_object_list)
	(e_cal_backend_http_get_free_busy)
	(e_cal_backend_http_get_changes)
	(e_cal_backend_http_discard_alarm)
	(e_cal_backend_http_modify_object)
	(e_cal_backend_http_remove_object)
	(e_cal_backend_http_receive_objects)
	(e_cal_backend_http_send_objects)
	(e_cal_backend_http_internal_get_default_timezone)
	(e_cal_backend_http_internal_get_timezone): Implement with fallthrough
	to slave backend.
	(e_cal_backend_http_init): Remove cruft.

	* calendar/libedatacal/e-cal-backend-sync.c
	(e_cal_backend_sync_open): Use per-instance mutex.
	(e_cal_backend_sync_init): Set up per-instance mutex.
	(e_cal_backend_sync_dispose): Free per-instance mutex.

	* calendar/libedatacal/e-cal-backend.c
	(e_cal_backend_set_notification_proxy): Implement.
	(e_cal_backend_notify_object_created)
	(e_cal_backend_notify_object_modified)
	(e_cal_backend_notify_object_removed)
	(e_cal_backend_notify_mode)
	(e_cal_backend_notify_error): Use notification proxy if set.
